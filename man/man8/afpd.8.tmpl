.TH afpd 8 "06 Jan 2004" 2.0.0 Netatalk 
.SH NAME
afpd \- AppleTalk Filing Protocol daemon
.SH SYNOPSIS
\fBafpd\fR [\-duptDTvI] [\-f \fBdefaultvolumes\fR] [\-s \fBsystemvolumes\fR] [\-n \fBnbpname\fR] [\-c \fBmaxconnections\fR] [\-g \fBguest\fR] [\-P \fBpidfile\fR] [\-S \fBport\fR] [\-L \fBmessage\fR] [\-F \fBconfig\fR] [\-U \fBuamsv\fR] [\-m \fBumask\fR]
.SH DESCRIPTION
afpd provides an AppleTalk Filing Protocol (AFP)
interface to the Unix file system. It is normally started at boot time
from /etc/rc. 
.PP
The list of volumes offered to the user is generated from
\fB:ETCDIR:/AppleVolumes.system\fR and one of
\fB:ETCDIR:/AppleVolumes.default\fR, \fB~/AppleVolumes\fR,
or \fB~/.AppleVolumes\fR. The \fBAppleVolumes\fR
files is used to specify volumes to mount and file name extension
mappings. It is formatted as follows, one specification per line: pathname
[ volumename ] .extension [ type [ creator ] ] If volumename is
unspecified, the last component of pathname is used. No two volumes may
have the same name. If type is unspecified '????' is used. If
creator is unspecified 'UNIX' is used. The extension '.'
sets the default creator and type for otherwise untyped Unix files. Blank
lines and lines beginning with `#' are ignored.
.PP
.SH OPTIONS
.TP 
\-d
Specifies that the daemon should not fork. If netatalk has been
configured with \fI\-\-enable\-debug1\fR, a trace of
all AFP commands will be written to stdout.
.TP 
\-p
Prevents clients from saving their passwords. (Equivalent to \-\fBnosavepasswd\fR
in \fBafpd.conf\fR.)
.TP 
\-t
Allows clients to change their passwords. (Equivalent to
\fB\-setpasswd\fR in \fBafpd.conf\fR.)
.TP 
\-D
Use DDP (AppleTalk) as transport protocol. (Equivalent to
\fB\-ddp\fR in \fBafpd.cond\fR.)
.TP 
\-T
Use TCP/IP as transport protocol. (Equivalent to
\fB\-tcp\fR in \fBafpd.conf\fR.)
.TP 
\-v
Print version information and exit.
.TP 
\-I
Use a platform specific icon. (Equivalent to \fB\-icon\fR
in \fBafpd.conf\fR.)
.TP 
\-f \fIdefaultvolumes\fR
Specifies that \fIdefaultvolumes\fR
should be read for a list of default volumes to offer, instead of
\fB:ETCDIR:/AppleVolumes.default\fR.
.TP 
\-s \fIsystemvolumes\fR
Specifies that \fIsystemvolumes\fR should
be read for a list of volume that all users will be offered, instead
of \fB:ETCDIR:/AppleVolumes.system\fR.
.TP 
\-u
Read the user's \fBAppleVolumes\fR file
first. This option causes volume names in the user's
\fBAppleVolumes\fR file to override volume names in
the system's \fBAppleVolumes\fR file. The default
is to read the system \fBAppleVolumes\fR file first.
Note that this option doesn't effect the precendence of filename
extension mappings: the user's \fBAppleVolumes\fR
file always has precedence.
.TP 
\-n \fInbpname\fR
Specifies that \fInbpname\fR should be
used for NBP registration, instead of the first component of the
hostname in the local zone.
.TP 
\-c \fImaxconnections\fR
Specifies the maximum number of connections to allow for this
afpd. The default is 20.
.TP 
\-g \fIguest\fR
Specifies the name of the guest account. The default is
\&'\fInobody\fR'.
.TP 
\-P \fIpidfile\fR
Specifies the file in which afpd stores its
process id.
.TP 
\-S \fIport\fR
Specifies the port to register with when doing AFPoverTCP.
Defaults to 548. (Equivalent to \fB\-port \fRin
\fBafpd.conf\fR.)
.TP 
\-L \fImessage\fR
Specifies the login message that will be sent to clients.
(Equivalent to \fB\-loginmsg\fR in \fBafpd.conf\fR.)
.TP 
\-F \fIconfigfile\fR
Specifies the configuration file to use. (Defaults to
\fB:ETCDIR:/netatalk/afpd.conf\fR.)
.TP 
\-U \fIuams\fR
Comma\-separated list of UAMs to use for the authentication
process. (Equivalent to \fB\-uamlist\fR in
\fBafpd.conf\fR.)
.TP 
\-m \fIumask\fR
Use this umask for the creation of
folders in Netatalk.
.SH SIGNALS
Signals that are sent to the main afpd process
are propagated to the children, so all will be affected.
.TP 
SIGHUP
Sending a SIGHUP to afpd will cause it to
reload its configuration files.
.TP 
SIGUSR1
The afpd process will send the message
"The server is going down for maintenance." to the client
and shut itself down in 5 minutes. New connections are not allowed.
If this is sent to a child afpd, the other children are not
affected. However, the main process will still exit, disabling all
new connections.
.TP 
SIGUSR2
The afpd process will look in the message
directory configured at build time for a file named message.pid. For
each one found, a the contents will be sent as a message to the
associated AFP client. The file is removed after the message is
sent. This should only be sent to a child afpd.
Warning: If the \-\-with\-message\-dir option was not used, this will
kill the afpd process

To shut down a user's afpd process it
is recommended that SIGKILL (\-9)
\fINOT\fR be used, except as a last resort, as this
may leave the CNID database in an inconsistent state. The safe way
to terminate an afpd is to send it a
SIGTERM (\-15) signal and wait for it to die on
its own.
.SH FILES
.TP 
\fB:ETCDIR:/AppleVolumes.default\fR
list of default volumes to mount
.TP 
\fB:ETCDIR:/AppleVolumes.system\fR
list of volumes to offer all users
.TP 
\fB~/AppleVolumes\fR
user's list of volumes to mount
.TP 
\fB:ETCDIR:/netatalk/msg/message.pid\fR
contains messages to be sent to users.
.SH BUGS
.SH "SEE ALSO"
\fBhosts_access\fR(5),
\fBafpd.conf\fR(5),
\fBAppleVolumes.default\fR(5),
\fBAppleVolumes.system\fR(5).

