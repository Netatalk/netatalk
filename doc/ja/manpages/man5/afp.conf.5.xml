<?xml version="1.0" encoding="UTF-8"?>
<refentry id="afp.conf.5">
  <refmeta>
    <refentrytitle>afp.conf</refentrytitle>

    <manvolnum>5</manvolnum>

    <refmiscinfo class="date">19 Mar 2017</refmiscinfo>

    <refmiscinfo class="source">@NETATALK_VERSION@</refmiscinfo>
  </refmeta>

  <refnamediv>
    <refname>afp.conf</refname>

    <refpurpose>Netatalkの設定ファイル</refpurpose>
  </refnamediv>

  <refsect1>
    <title>概要</title>

    <para><filename>afp.conf</filename>は<emphasis role="bold">Netatalk</emphasis> AFPファイルサーバの設定ファイルである。</para>

    <para>全てのAFP固有の設定とAFPボリュームの定義がこのファイルを通して行われる。</para>
  </refsect1>

  <refsect1 id="FILEFORMATSECT">
    <title>ファイルの書式</title>

    <para>ファイルはセクションとパラメータから構成される。セクションはブラケット[各括弧]で囲まれたセクション名に始まり、次のセクションが始まるまで続く。セクションには次のような書式のパラメータが含まれている:
    <programlisting>
    <replaceable>name</replaceable> = <replaceable>value </replaceable>
    </programlisting></para>

    <para>このファイルは行を基本とする。それぞれの行は改行文字で終端し、コメント、セクション名、パラメータのうちどれかを表す。</para>

    <para>セクション名とパラメータ名は大文字と小文字の区別がある。</para>

    <para>パラメータに最初に現れる等号だけは重要な意味を持つ。最初の等号の前後にある空白は破棄される。セクション名とパラメータ名の前、後、途中にある空白は意味を持たない。パラメータ値の前後の空白は破棄される。パラメータ値の途中の空白はそのま維持される。</para>

    <para>セミコロン(<quote>;</quote>)やハッシュ文字(<quote>#</quote>)で始まるいかなる行も、空白だけの行と同様に無視される。</para>

    <para><quote> <literal>\</literal> </quote>で終わるいかなる行も、通例のUNIX方式で次の行に続くことを意味する。</para>

    <para>パラメータにおいて等号の後ろに続く値は、文字列(引用符は必要ない)または真偽値である。真偽値はyes/no、1/0、true/falseで表現する。大文字と小文字の区別は真偽値では意味を持たないが、文字列では保存される。「file perm」のようないくつかの項目は数値を表す。</para>

    <para>「<option>include =　<replaceable>path</replaceable></option>」というパラメータは、設定ファイルの中にもう一つの設定ファイルを組み込むことを可能にする。そのファイルはまるでその場所に書き込まれたように、そっくりそのまま組み込まれる。入れ子になった組み込みはサポートされない。</para>
  </refsect1>

  <refsect1>
    <title>セクションの説明</title>

    <para>設定ファイル中のそれぞれのセクション([Global]セクション以外)は共有リソース(<quote>volume</quote>として知られる)を記述する。セクション名はボリュームの名前であり、セクション内のパラメータはボリューム属性とオプションを定義する。</para>

    <para>[Global]と[Homes]という二つの特殊なセクションがあるが、これについては下の方の<emphasis>特殊なセクション</emphasis>で説明する。以下の解説は通常のセクションに適用される。</para>

    <para>一つのボリュームは、アクセスを許可するディレクトリ設定と、そのサービスにおいてユーザに与えるアクセス権設定で成り立つ。ボリュームに対して<option>path</option>オプションを使って共有ディレクトリを指定しなければならない。</para>

    <para><option>path</option>オプションのないボリュームセクションは、他のボリュームセクションから<option>vol preset</option>オプション経由で呼び出され、ボリュームのデフォルト値を決める<emphasis>ボリュームプリセット</emphasis>と見なされる。プリセット<emphasis>と</emphasis>ボリュームセクションの両方で指定されたオプションについては、ボリュームオプション設定がプリセットオプションを完全に上書きする。</para>

    <para>サーバが許可したアクセス権は、ホストシステムの特定のUNIXユーザまたはゲストユーザのアクセス権でマスクされる。サーバはホストシステムの許可以上の許可をしない。</para>

    <para>以下のセクションの例は、一つのAFPボリュームを定義している。ユーザはパス<filename>/foo/bar</filename>への完全なアクセス権を持つ。 <literal>baz</literal>という共有名でアクセスできる:
    <programlisting> [baz]
    path = /foo/bar </programlisting></para>
  </refsect1>

  <refsect1>
    <title>特殊なセクション</title>

    <refsect2>
      <title>[Global]セクション</title>

      <para>このセクションのパラメータはサーバ全体に適用される。以下で(G)の印がついているパラメータはこのセクションで設定しなければならない。</para>
    </refsect2>

    <refsect2>
      <title>[Homes]セクション</title>

      <para>このセクションはUNIXサーバ側のユーザのホームディレクトリを共有できるようにする。オプションの<option>path</option>パラメータを指定すると、ユーザのホームディレクトリ全体ではなく、サブディレクトリ<option>path</option>が共有される。<option>basedir regex</option>オプションを定義する必要がある。これはホームディレクトリの親ディレクトリにマッチする正規表現である。(H)の印がついているパラメータはこのボリュームセクション用である。オプションパラメータ<option>home name</option>はAFPボリューム名を変更するのに使うものであり、デフォルトは<emphasis>$u's home</emphasis>である。下の「変数置換」の項を見よ。</para>

      <para>以下の例でこれを解説する。全てのユーザのホームディレクトリは<filename>/home</filename>の下にある:
      <programlisting> [Homes]
      path = afp-data
      basedir regex = /home</programlisting>
      ユーザ<emphasis>john</emphasis>について、<filename>/home/john/afp-data</filename>というパスがAFPホームボリュームになる。</para>

      <para><option>basedir regex</option>ががシンボリックリンクを含む場合、正規化した絶対パスを設定してください。<filename>/home</filename>が<filename>/usr/home</filename>にリンクしているとき:
      <programlisting> [Homes]
      basedir regex = /usr/home</programlisting></para>
    </refsect2>
  </refsect1>

  <refsect1>
    <title>パラメータ</title>

    <para>パラメータはセクション固有の属性を定義する。</para>

    <para>いくつかのパラメータは[Global]セクションに固有のものである(たとえば<emphasis>log type</emphasis>)。それ以外は全てボリュームセクションのみに許される。(<emphasis>G</emphasis>)はパラメータが[Global]セクション固有であることを示す。(<emphasis>V</emphasis>)はボリューム固有のセクションで指定できることを示す。</para>
  </refsect1>

  <refsect1>
    <title>変数置換</title>

    <para>ボリューム名で変数を使うことができる。パスでの変数の利用は$uに限られる。</para>

    <orderedlist>
      <listitem>
        <para>不明な変数を指定した場合、それは変換されない。</para>
      </listitem>

      <listitem>
        <para>既知の変数を指定したが変数が値を持たない場合、それは無視される。</para>
      </listitem>
    </orderedlist>

    <para>置換に使われる変数は以下のとおり:</para>

    <variablelist>
      <varlistentry>
        <term>$b</term>

        <listitem>
          <para>ベース名</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>$c</term>

        <listitem>
          <para>クライアントのIPアドレス</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>$d</term>

        <listitem>
          <para>サーバ上のボリュームパス名</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>$f</term>

        <listitem>
          <para>フルネーム (passwdファイルのGECOSフィールドの内容)</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>$g</term>

        <listitem>
          <para>グループ名</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>$h</term>

        <listitem>
          <para>ホスト名</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>$i</term>

        <listitem>
          <para>クライアントのIPアドレス。ポート番号なし</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>$s</term>

        <listitem>
          <para>サーバ名 (ホスト名になることができる)</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>$u</term>

        <listitem>
          <para>ユーザ名 (ゲストの場合、ゲストとして動作しているユーザ名)</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>$v</term>

        <listitem>
          <para>ボリューム名</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>$$</term>

        <listitem>
          <para>ドル記号($)を表示する</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </refsect1>

  <refsect1>
    <title>グローバルパラメータの説明</title>

    <refsect2>
      <title>認証オプション</title>

      <variablelist>
        <varlistentry>
          <term>ad domain = <parameter>DOMAIN</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>認証時にユーザ名に@DOMAINを追加する。Active Directory環境で有用。さもなくば、完全な文字列user@domainで参加するユーザを要求するだろう。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>admin auth user = <parameter>user</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>例えば"<option>admin auth user = root</option>"を指定すると、通常ユーザのログインが失敗したときにafpdは必ず指定した<option>admin auth user</option>として認証を試みる。これが成功した場合、元の接続ユーザとして通常のセッションが確立される。言い換えると、あなたが<option>admin auth user</option>のパスワードを知っている場合、如何なる他のユーザとしてでも認証できる。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>admin group = <replaceable>group</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>信頼できるグループのユーザがログインしたときスーパユーザとして見えるようにする。このオプションはデフォルトで無効である。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>force user = <replaceable>USER</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>このサーバに接続する全ユーザへ、デフォルトユーザとして割り当てるUNIXユーザ名を指定する。これは共有ファイルに役立つ。間違ってセキュリティ問題を引き起こすような使い方が可能なので、それにも注意して利用すべきである。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>force group = <replaceable>GROUP</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>このサーバに接続する全ユーザへ、デフォルトプライマリグループとして割り当てるUNIXグループ名を指定する。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>k5 keytab = <replaceable>path</replaceable>
          <type>(G)</type></term>

          <term>k5 service = <replaceable>service</replaceable>
          <type>(G)</type></term>

          <term>k5 realm = <replaceable>realm</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>サーバがKerberos 5認証UAMをサポートする場合、これらが必要である。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>nt domain = <parameter>DOMAIN</parameter>
          <type>(G)</type></term>

          <term>nt separator = <parameter>SEPARATOR</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>例えばwinbind認証で利用し、有効かつ動作中のUAM認証を通して、ログイン時のユーザ名の前に両方の文字列を付けたもので認証を試みる。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>save password = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>yes</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>パスワードをローカルに保存するクライアントの機能を有効または無効にする。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>set password = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>chooserや「サーバへ接続」のダイアログを通してパスワードの変更をするクライアントの機能を有効または無効にする。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>uam list = <replaceable>uam list</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>スペースまたはカンマで区切られたUAMの一覧。(デフォルトは「uams_dhx.so uams_dhx2.so」)</para>

            <para>最も一般的に使われるUAMは以下の通り:</para>

            <variablelist>
              <varlistentry>
                <term>uams_guest.so</term>

                <listitem>
                  <para>ゲストログインを許可する</para>
                </listitem>
              </varlistentry>

              <varlistentry>
                <term>uams_clrtxt.so</term>

                <listitem>
                  <para>(uams_pam.soまたはuams_passwd.so) 暗号化なしで転送されたパスワードによるログインを許可する。(時代遅れ)</para>
                </listitem>
              </varlistentry>

              <varlistentry>
                <term>uams_randnum.so</term>

                <listitem>
                  <para>認証のための乱数および双方向乱数交換を許可する (パスワードを含んだファイル、つまり@pkgconfdir@/afppasswdファイルか"<option>passwd file</option>"で指定したファイルのどちらかが必要)。詳細は
                  <citerefentry>
                      <refentrytitle>afppasswd</refentrytitle>

                      <manvolnum>1</manvolnum>
                    </citerefentry>を見よ。(時代遅れ)</para>
                </listitem>
              </varlistentry>

              <varlistentry>
                <term>uams_dhx.so</term>

                <listitem>
                  <para>(uams_dhx_pam.soまたはuams_dhx_passwd.so) 認証のためのDiffie-Hellman交換(DHX)を許可する。</para>
                </listitem>
              </varlistentry>

              <varlistentry>
                <term>uams_dhx2.so</term>

                <listitem>
                  <para>(uams_dhx2_pam.soまたはuams_dhx2_passwd.so) 認証のためのDiffie-Hellman交換2(DHX2)を許可する。</para>
                </listitem>
              </varlistentry>

              <varlistentry>
                <term>uam_gss.so</term>

                <listitem>
                  <para>認証のためのKerberos Vを許可する。(オプション)</para>
                </listitem>
              </varlistentry>
            </variablelist>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>uam path = <replaceable>path</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>このサーバのためのUAMのデフォルトパスを設定する(デフォルトは@libdir@/netatalk)。</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </refsect2>

    <refsect2>
      <title>文字セットオプション</title>

      <para>OS XでAppleはAFP3プロトコルを導入した。大きな変更の一つは、AFP3は分解済UTF-8 (UTF8-MAC)としてエンコードされたUnicode名を用いることである。以前のAFP及びOSバージョンはMacRomanやMacCentralEuropeといった文字セットを用いた。</para>

      <para>AFP3と古いクライアントに同時に応対できるように、<command>afpd</command>はUTF-8とMac文字セットの間の変換ができる必要がある。OS Xですら部分的にMac文字セットに依存している。AFP3以前のクライアントが使うコードページを<command>afpd</command>が検出する方法はないので、あなたは<option>mac charset</option>オプションを使ってそれを指定しなけらばならない。デフォルトはMacRomanであり、多くの西欧ユーザにとって良いであろう。</para>

      <para><command>afpd</command>はUNIXオペレーティングシステムとも相互に作用する必要があるので、UTF8-MAC/Mac文字セットからUNIX文字セットへ変換できる必要がある。デフォルトで<command>afpd</command>は<emphasis>UTF8</emphasis>を用いる。<option>unix charset</option>オプションを使ってUNIX文字セットを設定できる。<command>afpd</command>のための設定ファイルで拡張文字セットを使う場合、端末が<option>unix charset</option>に一致することを確認してください。</para>

      <variablelist>
        <varlistentry>
          <term>mac charset = <parameter>CHARSET</parameter>
          <type>(G)/(V)</type></term>

          <listitem>
            <para>Macクライアントの文字セット、例えば<emphasis>MAC_ROMAN</emphasis>を指定する。これは文字列やファイル名をOS9やClassic環境のクライアントコードページに変換するために用いられる。すなわち認証やAFPメッセージ(SIGUSR2 messaging)である。これはボリュームの<option>mac charset</option>のデフォルトにもなる。デフォルトは<emphasis>MAC_ROMAN</emphasis>。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>unix charset = <parameter>CHARSET</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>サーバのunix文字セット、例えば<emphasis>ISO-8859-15</emphasis>や<emphasis>EUC-JP</emphasis>を指定する。これは文字列をシステムロケールとの間で変換するのに使われる。すなわち認証やサーバメッセージやボリューム名である。LOCALEが設定された場合、システムロケールが使われる。デフォルトはUTF8。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>vol charset = <parameter>CHARSET</parameter>
          <type>(G)/(V)</type></term>

          <listitem>
            <para>ボリュームのファイルシステムのエンコーディングを指定する。デフォルトでは<option>unix charset</option>と同じである。</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </refsect2>

    <refsect2>
      <title>パスワードオプション</title>

      <variablelist>
        <varlistentry>
          <term>passwd file = <parameter>path</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>このサーバの乱数UAMパスワードファイルのパスを設定する (デフォルトは@pkgconfdir@/afppasswd)。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>passwd minlen = <parameter>number</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>UAMが最小パスワード長をサポートする場合、それを設定する。</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </refsect2>

    <refsect2>
      <title>ネットワークオプション</title>

      <variablelist>
        <varlistentry>
          <term>advertise ssh = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>古いMac OS Xクライアント(10.3.3から10.4)にSSHでトンネルしたAFP接続を魔法のように自動的に確立させる。このオプションを設定した場合、クライアントのFPGetSrvrInfo要求へのサーバの返答は追加エントリを含む。これはクライアントの設定と<citerefentry>
                <refentrytitle>sshd</refentrytitle>

                <manvolnum>8</manvolnum>
              </citerefentry>が正しく設定されて動作するサーバ上で実行中であるかに依存する。</para>

            <note>
              <para>SSHを介した全体を暗号化するAFP接続はサーバの負荷を著しく増加させるので、このオプションの設定は推奨しない。一方、バージョン10.3.4より前のMacOS Xにおけるこの機能のAppleクライアント側の実装はセキュリティ欠陥があった。</para>
            </note>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>afp interfaces = <replaceable>name [name ...]</replaceable>
            <type>(G)</type></term>
          <listitem>
            <para>サーバがリッスンするネットワークインターフェースを指定する。デフォルトではシステムの最初のIPアドレスを宣伝するが、入ってくる如何なる要求もリッスンする。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>afp listen = <replaceable>ip address[:port] [ip address[:port]
          ...]</replaceable> <type>(G)</type></term>

          <listitem>
            <para>サーバが宣伝<emphasis role="bold">および</emphasis>リッスンするIPアドレスを指定する。デフォルトではシステムの最初のIPアドレスを宣伝するが、入ってくる如何なる要求もリッスンする。ネットワークアドレスはIPv4のドット付き10進数フォーマットやIPv6の16進数フォーマットのどちらでも指定してよい。</para>
            <para>IPv6 address + portの組み合わせは角かっこを使ったフォーマット[IPv6]:portのURLを使わなければならない。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>afp port = <replaceable>port number</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>異なるTCPポートをAFPに使わせる。デフォルトは548である。<option>afp listen</option>オプションで何も指定しなかった場合も適用されたデフォルトポートを設定する。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>cnid listen = <replaceable>ip address[:port] [ip
          address[:port] ...]</replaceable> <type>(G)</type></term>

          <listitem>
            <para>CNIDサーバがリッスンするIPアドレスを指定する。デフォルトは<emphasis role="bold">localhost:4700</emphasis>である。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>disconnect time = <replaceable>number</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>ドロップする前に、切断されたAFPセッションを<parameter>number</parameter>時間維持する。デフォルトは24時間である。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>dsireadbuf = <replaceable>number</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>DSI/TCP先読みバッファのサイズを決定する係数。デフォルトは12である。これにDSI server quantum (デフォルトは1MiB)をかけるとバッファサイズになる。この値を増やすと速いローカルネットワークでのボリュームからボリュームへのコピーのスループットが増えるかもしれない。 <emphasis>注記</emphasis>: このバッファはafpdの子プロセス毎に割り当てられるので、大きな値を指定すると大量のメモリが食われる (バッファサイズ * クライアント数)。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>fqdn = <replaceable>name[:port]</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>完全修飾ドメイン名をオプションのポート番号と共に指定する。サーバがこれを解決できない場合は破棄される。AppleShare clients 3.8.3以前はこのオプションを評価しない。このオプションはデフォルトで無効である。これによりクライアント側は名前解決を二段階踏むことになるので注意して使ってください。afpdはこのname:portの組み合わせを宣伝しますが自動的にはリッスンしないことにも注意してください。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>hostname = <replaceable>name</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>宣伝用のIPアドレスを決定するため、ホスト名の呼出結果の代わりにこれを用いる。従って、このホスト名から宣伝用IPアドレスが解決されるようになる。これはリスニングには使われないし、<option>afp listen</option>によっても上書きされてしまう。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>max connections = <replaceable>number</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>同時にサーバに接続できるクライアントの最大数を設定する(デフォルトは200)。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>server quantum = <replaceable>number</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>これはDSI server quantumを指定する。デフォルト値は0x100000 (1MiB)である。最大値は0xFFFFFFFFFであり最小値は32000である。範囲外の値を指定した場合、デフォルト値が設定される。自分が何をしようとしているか確信がない限り、この値を変更しないでください。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>sleep time = <replaceable>number</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>スリープモードにおいてクライアントを切断する前に、スリープ中のAFPセッションを<parameter>number</parameter>時間維持する。デフォルトは10時間である。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>tcprcvbuf = <replaceable>number</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>setsockopt()を使ってTCP受信バッファの設定を試みる。しばしばOSはこの値を設定しようとするアプリケーションの資格を制限します。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>tcpsndbuf = <replaceable>number</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>setsockopt()を使ってTCP送信バッファの設定を試みる。しばしばOSはこの値を設定しようとするアプリケーションの資格を制限します。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>recvfile = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>データ受信のためにLinuxのsplice()を使うかどうか。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>splice size = <replaceable>number</replaceable> (デフォルト:
          <emphasis>64k</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>spliceする最大バイト数。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>use sendfile = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>yes</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>クライアントにファイルデータを送るためにsendfile<indexterm>
                <primary>sendfile</primary>
              </indexterm>システムコールを使うかどうか。</para>
          </listitem>
        </varlistentry>


        <varlistentry>
          <term>zeroconf = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>yes</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>AvahiまたはmDNSResponder込みでコンパイル済の場合、自動的なZeroconf<indexterm>
                <primary>Zeroconf</primary>

                <secondary>Bonjour</secondary>
              </indexterm>サービス登録を使うかどうか。</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </refsect2>

    <refsect2>
      <title>雑多なオプション</title>

      <variablelist>
        <varlistentry>
          <term>afp read locks = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>FPReadコールにおいてバイト領域リードロックを適用するかどうか。AFPの仕様はこれを義務付けるが、実際のところこれはUNIXの動作に合致しないし、パフォーマンスを抑え込む。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>afpstats = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>dbusを介してAFPランタイム統計 (接続ユーザ、開いてるボリューム) を提供するかどうか。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>basedir regex = <replaceable>regex</replaceable>
          <type>(H)</type></term>

          <listitem>
            <para>ユーザホームの親ディレクトリにマッチする正規表現。<option>basedir regex</option>がシンボリックリンクを含む場合、正規化した絶対パスを設定しなければならない。簡単なケースだとこれは単に一つのパスである。つまり<option>basedir regex = /home</option>である。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>chmod request = <replaceable>preserve (デフォルト) | ignore | simple</replaceable>
          <type>(G)/(V)</type></term>

          <listitem>
            <para>ACLに対応する高度なパーミッション制御。</para>

            <itemizedlist>
              <listitem><para> <option>ignore</option> - UNIXのchmod()要求を完全に無視する。新規作成を上書きして親ディレクトリのACL継承に完全コントロールさせるためにこのオプションを使う。</para></listitem>
              <listitem><para>
                <option>preserve</option> - 名前付きユーザとグループのためのZFS ACEやPOSIX ACLグループマスクを維持する
		      </para></listitem>
              <listitem><para>
		<option>simple</option> -  いかなる追加の手順も踏まず、単に要求通りにchmod()する
		      </para></listitem>
		    </itemizedlist>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>close vol = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>ボリュームが設定から削除され、その設定が再読み込みされたとき、クライアントが既に開いているボリュームを可能な限り閉じるかどうか。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>cnid mysql host = <replaceable>MySQL server address</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>mysql CNIDバックエンド利用時のMySQLサーバの名前またはアドレス。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>cnid mysql user = <replaceable>MySQL user</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>MySQLサーバ認証のためのユーザ名。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>cnid mysql pw = <replaceable>password</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>MySQLサーバのためのパスワード。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>cnid mysql db = <replaceable>database name</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>指定ユーザが完全アクセス権を持つための存続しているデータベースの名前。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>cnid server = <replaceable>ipaddress[:port]</replaceable>
          <type>(G)/(V)</type></term>

          <listitem>
            <para>cnid_metadサーバのIPアドレスとポート番号を指定する。CNID dbdバックエンドのために必要。デフォルトはlocalhost:4700。ネットワークアドレスはIPv4のドット分割10進数フォーマットでもよいし、IPv6の16進数フォーマットでもよい。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>dbus daemon = <parameter>path</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>Spotlight機能が使用するdbus-daemon実行ファイルのパスを設定する。デフォルト値 <filename>[@DBUS_DAEMON_PATH@]</filename> はnetatalkのビルド時に決定される。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>dircachesize = <replaceable>number</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>ディレクトリキャッシュにおける最大エントリ数。キャッシュはディレクトリとファイルを格納する。これはディレクトリのフルパスと、ディレクトリ一覧を大幅にスピードアップするCNIDをキャッシュするために使われる。</para>

            <para>デフォルトサイズは8192、最大サイズは131072。与えられた値は最も近い2の累乗に丸められる。それぞれのエントリは約100バイトを消費し、これは大きな値とは言えないが、それぞれの接続ユーザ毎のafpd子プロセスがキャッシュを持つことを念頭に置いてください。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>extmap file = <parameter>path</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>ファイル拡張子とタイプ/クリエータのマッピングを定義するファイルのパスを設定する。(デフォルトは@pkgconfdir@/extmap.confである)</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>force xattr with sticky bit =
          <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(G/V)</type></term>

          <listitem>
            <para>ディレクトリへの書き込み権限があったとしても、スティッキービット設定を使ってメタデータ(拡張属性)を書き込むことに失敗するかもしれない。なぜなら、スティッキービットが設定されている場合、所有者だけが拡張属性への書き込みを許されるからである。</para>

            <para>このオプションを有効にするとNetatalkはroot権限でメタデータ(拡張属性)を書き込む。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>guest account = <replaceable>name</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>ゲストが利用するユーザ名を指定する (デフォルトは"nobody"である)。ユーザ名は引用符で囲むべきである。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>home name = <replaceable>name</replaceable>
          <type>(H)</type></term>

          <listitem>
            <para>AFPユーザのホームのボリューム名。デフォルトは<emphasis>$u's home</emphasis>である。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ignored attributes = <replaceable>all | nowrite | nodelete | norename</replaceable>
          <type>(G)/(V)</type></term>

          <listitem>
            <para>サーバが無視すべきファイルとディレクトリの属性を設定する。<option>all</option>はオプション全部という意味である。</para>
            <para>OS Xにおいて、Finderがファイル/ディレクトリのロックを設定する場合、またはターミナルでBSD uchgフラグを設定する場合、3つの属性が全て使われる。従って、Finderロック/BSD uchgフラグを無視する目的で<emphasis>ignored attributes = all</emphasis>の設定を追加してください。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>login message = <replaceable>message</replaceable>
          <type>(G)/(V)</type></term>

          <listitem>
            <para>クライアントがサーバにログオンしたときに表示されるメッセージを設定する。メッセージは<option>unix charset</option>で書いて引用符で囲むべきです。拡張文字が使えます。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>mimic model = <replaceable>model</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>クライアント上に表示されるアイコンモデルを指定する。デフォルトではオフになっている。netatalkがZeroconfをサポートしなければならないことに注意してください。例: RackMac (same as Xserve), PowerBook, PowerMac,
            Macmini, iMac, MacBook, MacBookPro, MacBookAir, MacPro,
            AppleTV1,1, AirPort.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>signature = &lt;text&gt; <type>(G)</type></term>

          <listitem>
            <para>サーバシグネチャを指定する。最大長は16文字である。このオプションは障害隔離などを提供するクラスタ環境において有用である。デフォルトでは、afpdは自動的にシグネチャを(乱数を元に)生成し、それを<filename>@localstatedir@/netatalk/afp_signature.conf</filename>に保存する。asip-status.pl(1)も見よ。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>solaris share reservations =
          <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>yes</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>Solarisの共有予約を利用する。Solaris CIFSサーバもこれを利用するので、ロックを統一したマルチプロトコルサーバを形成する。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>sparql results limit =
          <replaceable>NUMBER</replaceable> (デフォルト:
          <emphasis>無制限</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>SPARQLクエリを介したTrackerからのクエリ結果の数に制限を課す。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>spotlight =
          <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(G)/(V)</type></term>

          <listitem>
            <para>Spotlight検索を有効にするかどうか。注記: 一度グローバルオプションで有効にすると、有効でないボリュームは全く検索できない。<emphasis>dbus daemon</emphasis>オプションも見よ。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>spotlight attributes =
          <replaceable>カンマで分割した文字列</replaceable> (デフォルト:
          <emphasis>空</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>Spotlight検索で使うことを許された属性のリスト。デフォルトでは全ての属性を検索できるが、文字列を渡せば属性をその文字列の要素に制限できる。 例:
	    <programlisting>spotlight attributes = *,kMDItemTextContent</programlisting></para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>spotlight expr =
          <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>yes</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>検索において論理式の使用を認めるかどうか。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>start dbus =
          <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>yes</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>Trackerを使うためにdbusインスタンスを開始するかどうか。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>start tracker =
          <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>yes</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>"<command>tracker daemon -s</command>"によってTrackerを開始するかどうか。古いTrackerの場合、"<command>tracker-control -s</command>"が代わりに使われる。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>veto message = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>禁止ファイルに関するオプションのAFPメッセージを送る。クライアントが禁止名を持つファイルやディレクトリにアクセスを試みたとき、名前とディレクトリを示したAFPメッセージを送る。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>vol dbpath = <replaceable>path</replaceable>
          <type>(G)/(V)</type></term>

          <listitem>
            <para>データベース情報をpathに格納するように設定する。ボリュームが読み込み専用だったとしても、書き込み可能な場所を設定しなければならない。デフォルトは<filename>@localstatedir@/netatalk/CNID/$v/</filename>である。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>vol dbnest = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>このオプションをtrueに設定するとNetatalk 2の動作に立ち返る。つまり、それぞれの共有のボリュームルートの下にある.AppleDBというフォルダにCNIDデータベースを格納する。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>volnamelen = <replaceable>number</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>Mac OS XのためのUTF8-MACボリューム名の最大長。ハングルはこれに特に敏感なので注意してください。</para>

            <para><programlisting>73: Mac OS X 10.1の制限
80: Mac OS X 10.4/10.5の制限 (デフォルト)
255: 最近のMac OS Xの制限</programlisting>
            Mac OS 9以前はこれに影響されない。なぜならMac文字セットのボリューム名は常に27バイト制限がある。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>vol preset = <replaceable>name</replaceable>
          <type>(G)/(V)</type></term>

          <listitem>
            <para>([Global]セクションで設定したときは) 全ボリューム、(ボリュームセクションで設定したときは)そのボリュームのオプション初期設定となるセクションの<option>name</option>を使う。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>zeroconf name = <replaceable>name</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>登録サービスをユニークに表した、人間が読めるnameを設定する。このzeroconf nameは最大長63オクテット（バイト）のUTF-8で宣伝される。netatalkがZeroconfをサポートしなければならないことに注意してください。</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </refsect2>

    <refsect2>
      <title>ログのオプション</title>

      <variablelist>
        <varlistentry>
          <term>log file = <replaceable>logfile</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>指定しない場合、Netatalkはsyslogデーモン機能にログを出力する。そうでない場合は<option>logfile</option>に出力する。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>log level = <replaceable>type:level [type:level
          ...]</replaceable> <type>(G)</type></term>

          <term>log level = <replaceable>type:level,[type:level,
          ...]</replaceable> <type>(G)</type></term>

          <listitem>
            <para>与えられた<option>log level</option>までのログレベルのメッセージを出力するように設定する。</para>

            <para>デフォルトではafpdは<option>default:note</option>に相当する設定でsyslogに出力する。</para>

            <para>ログタイプ: default, afpdaemon, logger, uamsdaemon</para>

            <para>ログレベル: severe, error, warn, note, info, debug, debug6,
            debug7, debug8, debug9, maxdebug</para>

            <note>
              <para>ログタイプとログレベルはどちらも大文字小文字を区別しない。</para>
            </note>
          </listitem>
        </varlistentry>
      </variablelist>
    </refsect2>

    <refsect2 id="fceconf">
      <title>ファイルシステム変更イベント (FCE<indexterm>
          <primary>FCE</primary>
        </indexterm>)</title>

	<para>Netatalk には素敵なファイルシステム変更イベント機構が含まれている．ここで， afpd プロセスは，なにがしかのファイルシステムイベントについて，関心を寄せているリスナーに， UDP ネットワークデータグラムで通知する．</para>

      <para>以下の FCE イベントが定義されている:</para>

      <itemizedlist>
        <listitem><para>ファイル変更 (<option>fmod</option>)</para></listitem>
        <listitem><para>ファイル削除 (<option>fdel</option>)</para></listitem>
        <listitem><para>ディレクトリ削除 (<option>ddel</option>)</para></listitem>
        <listitem><para>ファイル作成 (<option>fcre</option>)</para></listitem>
        <listitem><para>ディレクトリ作成 (<option>dcre</option>)</para></listitem>
        <listitem><para>ファイル移動または名前変更 (<option>fmov</option>)</para></listitem>
        <listitem><para>ディレクトリ移動または名前変更 (<option>dmov</option>)</para></listitem>
        <listitem><para>ログイン (<option>login</option>)</para></listitem>
        <listitem><para>ログアウト (<option>logout</option>)</para></listitem>
      </itemizedlist>

      <variablelist>
        <varlistentry>
          <term>fce listener = <replaceable>host[:port]</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>FCE イベントを指定された <parameter>host</parameter> に送ることができるようにする．もし指定されていなければデフォルトの <parameter>port</parameter> は 12250 である．複数のリスナーを指定するにはそれぞれのリスナーに対するオプションを一度に指定することである．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>fce version = <replaceable>1|2</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>FCE プロトコルのヴァージョンで，デフォルトでは 1 である．fmov，dmov，login あるいは logout イベントのためにはバージョン 2 が必要である．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>fce events =
          <replaceable>fmod,fdel,ddel,fcre,dcre,fmov,dmov,login,logout</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>どの FCE イベントがアクティブかを指定する．デフォルトでは <parameter>fmod,fdel,ddel,fcre,dcre</parameter> である．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>fce coalesce = <replaceable>all|delete|create</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>FCE イベントを結合する．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>fce holdfmod = <replaceable>seconds</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>これは，もしクライアントによって FCE ファイル変更イベント (fmod) を送信する前に同じファイルに対する別の変更が同時に行われる場合，常に待機する遅延時間を秒単位で決定する．例えば，フォトショップでファイルを保存することでそのファイル自体の複数のイベントを引き起こす．なぜなら，アプリケーションはその“保存する”たびにファイルを複数回，開き，変更しそして閉じるからである．デフォルトでは 60 秒である．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>fce ignore names = <replaceable>NAME[/NAME2/...]</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>FCE イベントを生成すべきでないファイル名をスラッシュで区切ったリスト．デフォルトでは .DS_Store．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>fce notify script = <replaceable>PATH</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>各々の FCE イベントに対して実行されるスクリプト．スクリプト例については，Netatalk のソースの contrib/shell_utils/fce_ev_script.sh を参照のこと．</para>
          </listitem>
        </varlistentry>

      </variablelist>
    </refsect2>

    <refsect2>
      <title>デバッグパラメータ</title>

      <para>これらのオプションはデバッグのみに有用である。</para>

      <variablelist>
        <varlistentry>
          <term>tickleval = <replaceable>number</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>tickleタイムアウトの間隔を(秒単位で)設定する。デフォルトは30。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>timeout = <replaceable>number</replaceable>
          <type>(G)</type></term>

          <listitem>
            <para>接続がタイムアウトする前に送るtickleの数を指定する。デフォルトは4なので、2分後に接続がタイムアウトする。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>client polling = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(G)</type></term>

          <listitem>
            <para>このオプションを有効にすると、afpdはserver notificationの機能があることを宣伝しない。これは、接続中のクライアントが開いているサーバのウインドウの変更を検出するために10秒毎にポーリングするのを目的としている。<emphasis>注記</emphasis>: 同時接続クライアント数とネットワークスピード次第でネットワークの負荷が相当に高くなる!</para>

            <para>現在のNetatalkはserver notificationを正確にサポートしており、接続中のクライアントは他のクライアントが内容を変更したときにフォルダ内の一覧を更新できるので、もはやこのオプションは使わないでください。</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </refsect2>

    <refsect2 id="acl_options">
      <title>ACL処理のためのオプション</title>

      <para>デフォルトでは、認証済ユーザの有効な権限は記載済UARights権限構造にだけマップされる。UNIXモードではない。この挙動は設定オプション<option>map acls</option>で調整できる:</para>

      <variablelist id="map_acls">
        <varlistentry>
          <term>map acls = <parameter>none|rights|mode</parameter>
          <type>(G)</type></term>

          <listitem>
            <para><variablelist>
                <varlistentry>
                  <term>none</term>

                  <listitem>
                    <para>ACLのマッピングをしない</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>rights</term>

                  <listitem>
                    <para>有効な権限がUARights構造にマップされる。これがデフォルトである。</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>mode</term>

                  <listitem>
                    <para>ACLはファイルシステムオブジェクトのUNIXモードにもマップされる。</para>
                  </listitem>
                </varlistentry>
              </variablelist></para>
          </listitem>
        </varlistentry>
      </variablelist>

      <para>もしクライアント上で ACL を表示できるようにしたければ， クライアントもサーバーも認証ドメイン（ディレクトリサービス，例えば，LDAP，Open Directory， Active Directory）の一部としてセットアップしなければならない．その理由は，OS X の ACL は単に uid ないしは gid と結合しているのではなく，UUID と結合しているからである．それ故，Netatalk は，OS X の UUID と紐付けした UNIX uid と gid に結合したサーバー側の ACL を返せるように，ファイルシステム全ての uid と gid を UUID と紐付けできるようにしなければならない．</para>

      <para>Netatalk は LDAP 検索を用いてディレクトリサーバーを検索をすることができる．ディレクトリサーバーが既にユーザーとグループの UUID 属性を提供している（Active Directory，Open Directory）か，ディレクトリサーバー（例えばOpenLDAP）の未使用の属性を再使用（あるいは新しい属性を追加）するか，のいずれかである．</para>

      <para>Netatalk では以下の LDAP オプションが設定されなければならない:</para>

      <variablelist>
        <varlistentry>
          <term>ldap auth method = <parameter>none|simple|sasl</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>認証方式: <option>none | simple |
            sasl</option></para>

            <para><variablelist>
                <varlistentry>
                  <term>none</term>

                  <listitem>
                    <para>匿名 LDAP 認証</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>simple</term>

                  <listitem>
                    <para>簡易 LDAP 認証</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>sasl</term>

                  <listitem>
                    <para>SASL. まだサポートされていない!</para>
                  </listitem>
                </varlistentry>
              </variablelist></para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap auth dn = <parameter>dn</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>簡易認証でのユーザーの識別名．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap auth pw = <parameter>password</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>簡易認証でのパスワード．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap server = <parameter>host</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>LDAP サーバーの名前か IP アドレス．これは，LDAP に UUID の問い合わせをできるようにするために，明示的な ACL サポートを必要とする時のみ必要．</para>

            <para>設定の構文的なチェックのために <citerefentry>
                <refentrytitle>afpldaptest</refentrytitle>

                <manvolnum>1</manvolnum>
              </citerefentry>
            を使うこともできる．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap userbase = <parameter>base dn</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>LDAP 内のユーザーコンテナの DN．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap userscope = <parameter>scope</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>ユーザー検索での検索スコープ: <option>base | one | sub</option></para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap groupbase = <parameter>base dn</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>LDAP 内のグループコンテナの DN．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap groupscope = <parameter>scope</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>グループ検索での検索スコープ: <option>base | one | sub</option></para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap uuid attr = <parameter>dn</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>UUID のある LDAP 属性の名前．</para>

            <para>注記: これはユーザーでもグループでも双方で用いられる．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap name attr = <parameter>dn</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>ユーザーの短縮名のある LDAP 属性の名前．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap group attr = <parameter>dn</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>グループの短縮名のある LDAP 属性の名前．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap uuid string = <parameter>STRING</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>ディレクトリでの UUID 文字列のフォーマット．'x' と '-'を続けたもので，それぞれの 'x' は 0-9a-f の値を示し，'-' はそれぞれ区切り文字である．</para>

            <para>デフォルト: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap uuid encoding = <parameter>string | ms-guid (デフォルト:
          string)</parameter> <type>(G)</type></term>

          <listitem>
            <para>LDAP 属性の UUID のフォーマットは Active Directory からの obhectGUID バイナリーフィールドの使用を許す．もし未指定のままだと string がデフォルトとなる．これはほとんどの LDAP ストアによって ASCII UUID を通して渡される．もし ms-guid が設定されると，サーバーと相互に動作する時 Active Directory 内にあるオブジェクトの objectGUID 属性で用いられる内部 UUID 表記とバイナリー形式が相互に変換される．</para>
            <para>オプション <option>ldap user filter</option> 及び <option>ldap group filter</option> も参照のこと．</para>
            <para><variablelist>
                <varlistentry>
                  <term>string</term>

                  <listitem>
                    <para>UUID は文字列．例えば OpenDirectory とで使用する．</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>ms-guid</term>

                  <listitem>
                    <para>Active Directory からの objectGUID バイナリー．</para>
                  </listitem>
                </varlistentry>
              </variablelist></para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap user filter = <parameter>STRING (デフォルト: 未使用)</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>ユーザーオブジェクトにマッチする任意の LDAP フィルター．これは，ユーザーとグループが同じディレクトリのサブツリーに保存されている Active Directory 環境で必要．</para>
            <para>Active Directory での推奨設定: <parameter>objectClass=user</parameter></para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ldap group filter = <parameter>STRING (デフォルト: 未使用)</parameter>
          <type>(G)</type></term>

          <listitem>
            <para>グループオブジェクトにマッチする任意の LDAP フィルター．これは，ユーザーとグループが同じディレクトリのサブツリーに保存されている Active Directory 環境で必要．</para>
            <para>Active Directory での推奨設定: <parameter>objectClass=group</parameter></para>
          </listitem>
        </varlistentry>

      </variablelist>
    </refsect2>
  </refsect1>

  <refsect1>
    <title>ボリュームパラメータの説明</title>

    <refsect2>
      <title>パラメータ</title>

      <para>セクション名ボリューム名を定義する．同じ名前の二つのボリュームというのは無いであろう．ボリューム名が文字 <keycode>':'</keycode> を含むことはできない． ボリューム名がとても長ければマングルされる．Mac キャラクターセットのボリューム名は27 文字までに制限される．UTF8-MAC ボリューム名は volnamelen パラメータで制限される．</para>

      <variablelist>
        <varlistentry>
          <term>path = <replaceable>PATH</replaceable> <type>(V)</type></term>

          <listitem>
            <para>パス名は完全修飾パス名でなければならない．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>appledouble = <replaceable>ea|v2</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>メタデータファイルのフォーマットを指定する．これは Mac のリソースフォークの保存にも用いられる．初期のバージョンでは AppleDouble v2 が用いられ，新しいデフォルトのフォーマットは <emphasis role="bold">ea</emphasis> である．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>vol size limit = <replaceable>MiB 単位でのサイズ</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>Time Machine に有用：報告されるボリュームサイズを制限する．故に Time Machine がバックアップのために実ディスク領域全体を使うことを防止する．例えば "vol size limit = 1000" は報告されるディスク領域を 1 GB に制限する． <emphasis role="bold">重要:</emphasis> これは Time Machine sparsebundle イメージの中身を考慮した概算である．それ故このオプションを使用した時，このボリュームを他のコンテンツを保管するのに使用 “してはならない”．なぜなら勘定に入っていないからである．計算は: sparsebundle の Info.plist XML ファイルからバンドサイズを読む，バンドファイルの数を数えて バンド／ディレクトリ を読む，そしてお互いの乗算をする．ことによって行われる．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>valid users = <replaceable>user @group</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>この許可オプションは指定された共有にそのユーザーとグループのアクセスを許可する．ユーザーとグループはスペースかコンマで区切って指定する．グループは @ プレフィックスで明示する．名前の中にあるスペースを許すために名前を引用符で囲んでもよい．例:
            <programlisting>valid users = user "user 2" @group “@group 2"</programlisting></para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>invalid users = <replaceable>users/groups</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>この拒否オプションはその共有にアクセスを許可しないユーザーとグループを指定する．それ以外は "valid users" オプションと同じフォーマットである．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>hosts allow = <replaceable>IPホストアドレス/IPマスクビット [
          ... ]</replaceable> <type>(V)</type></term>

          <listitem>
            <para>列挙されたホストとネットワークのみが許可され，ほかの全ては拒否される．ネットワークアドレスは IPv4 のドット区切りフォーマット， IPv6の16進数フォーマットのどちらでもよい．</para>

            <para>例: hosts allow = 10.1.0.0/16 10.2.1.100
            2001:0db8:1234::/48</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>hosts deny = <replaceable>IPホストアドレス/IPマスクビット [
          ... ]</replaceable> <type>(V)</type></term>

          <listitem>
            <para>列挙されたホストとネットのみが拒否され，ほかの全ては許可される．</para>

            <para>例: hosts deny = 192.168.100/24 10.1.1.1
            2001:db8::1428:57ab</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>cnid scheme = <replaceable>backend</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>そのボリュームに使う CNID バックエンドをセットする．デフォルトのバックエンドは [@DEFAULT_CNID_SCHEME@] で，有効なバックエンドは [@compiled_backends@] である．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ea = <replaceable>none|auto|sys|ad|samba</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>拡張属性<indexterm>
                <primary>拡張属性</primary>
              </indexterm>をどのように保存するか指定する． <option>auto</option> がデフォルトである．</para>

            <variablelist>
              <varlistentry>
                <term>auto</term>

                <listitem>
                  <para>（共有ディレクトリ自体に EA を設定することにより） <option>sys</option> を試行して，フォールバックすると <option>ad</option> になる．試行を実行するためにはボリュームが書き込み可能であることが必要である． "<option>read only = yes</option>" ならば <option>auto</option> は <option>none</option> で上書きされる．書き込み専用のボリュームには必要に応じて明確に "<option>ea = sys|ad</option>" を使ってください．</para>
                </listitem>
              </varlistentry>

              <varlistentry>
                <term>sys</term>

                <listitem>
                  <para>ファイルシステムの拡張属性を使う．</para>
                </listitem>
              </varlistentry>

	      <varlistentry>
                <term>samba</term>

                <listitem>
                  <para>ファイルシステムの拡張属性を使うが，Sambaのvfs_streams_xattrとの互換性の目的で，それぞれの拡張属性に値がゼロの1バイトを追加する．</para>                </listitem>
              </varlistentry>

              <varlistentry>
                <term>ad</term>

                <listitem>
                  <para><emphasis>.AppleDouble</emphasis> ディレクトリ内のファイルを使う．</para>
                </listitem>
              </varlistentry>

              <varlistentry>
                <term>none</term>

                <listitem>
                  <para>拡張属性をサポートしない．</para>
                </listitem>
              </varlistentry>
            </variablelist>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>mac charset = <replaceable>CHARSET</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>もしグローバル設定を適用する指定がなければ，そのボリュームに対しての Mac クライアントのキャラクターセット，例えば <emphasis>MAC_ROMAN</emphasis>，<emphasis>MAC_CYRILLIC</emphasis> 等を指定する．この設定は Mac キャラクターセットが [Global] セクションで全体的にセットしたキャラクターセットと異なるというボリュームを必要とする時のみ必須である．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>casefold = <option>option</option> <type>(V)</type></term>

          <listitem>
            <para>ファイル名の大文字小文字を変更すべき場合，casefold オプションが処理する．有効なオプションは:</para>

            <para><option>tolower</option> - 双方向で名前を小文字に変換する。</para>

            <para><option>toupper</option> - 双方向で名前を大文字に変換する。</para>

            <para><option>xlatelower</option> - クライアントでは小文字に見えて、サーバでは大文字に見える。</para>

            <para><option>xlateupper</option> - クライアントでは大文字に見えて、サーバでは小文字にみえる。</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>password = <replaceable>password</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>このオプションはボリュームパスワードの設定を許可する．パスワードは最大で 8 文字の長さ（これを記入するときには ASCII を強く推奨）</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>file perm = <replaceable>mode</replaceable>
          <type>(V)</type></term>

          <term>directory perm = <replaceable>mode</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>クライアントが要求した権限との論理和(or)をとる． <option>file perm</option> はファイルにのみ， <option>directory perm</option> はディレクトリにのみ用いる． "<option>unix priv = no</option>" と共に用いてはならない．</para>

            <example>
              <title>共同ワークグループ用ボリューム</title>

              <para><programlisting>file perm = 0660
directory perm = 0770</programlisting></para>
            </example>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>umask = <replaceable>mode</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>権限のマスクを設定する． "<option>unix priv = no</option>" と共に用いてはならない．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>preexec = <replaceable>command</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>ボリュームがマウントされる時に実行されるコマンド</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>postexec = <replaceable>command</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>ボリュームが閉じられる時に実行されるコマンド</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>root preexec = <replaceable>command</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>ボリュームがマウントされる時にルート権限で実行されるコマンド</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>root postexec = <replaceable>command</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>ボリュームが閉じられる時にルート権限で実行されるコマンド</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>rolist = <option>users/groups</option> <type>(V)</type></term>

          <listitem>
            <para>信頼するユーザー及びグループの共有に対する読み込み専用アクセスを許可する．フォーマットは allow オプションに準ずる．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>rwlist = <replaceable>users/groups</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>信頼するユーザー及びグループの共有に対する読み込み／書き込みアクセスを許可する．フォーマットは allow オプションに準ずる．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>veto files = <replaceable>vetoed names</replaceable>
          <type>(V)</type></term>

          <listitem>
            <para>'/' で区切られた 禁止名のどれかに一致するパスのファイルとディレクトリを隠す．禁止文字列は常に '/' で終わらなければならない．例えば，"veto files = veto1/"，"veto files = veto1/veto2/"．</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </refsect2>

    <refsect2>
      <title>ボリュームオプション</title>

      <para>ブーリアン型のボリュームオプション．</para>

      <variablelist>
        <varlistentry>
          <term>acls = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>yes</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>ボリュームが ACL をサポートしてるというフラグを立てるかどうか． もし ACL サポートでコンパイルしていれば，これはデフォルトで yes．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>case sensitive = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>yes</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>ボリュームが大文字小文字を区別したファイル名をサポートしてるというフラグを立てるかどうか． もしファイルシステムが大文字小文字を区別しなければ no を設定せよ．しかしながらこれは完全には確かめられていない．</para>
            <note>
              <para>実際には大文字小文字を区別しているにもかかわらず，netatalk 3.1.3 とそれ以前のものはクライアントに kCaseSensitive フラグを通知しなかった．バージョン 3.1.4 からはデフォルトで正しく通知される．</para>
            </note>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>cnid dev = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>yes</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>CNID バックエンド内でデバイス番号を使うかどうか． 例えばクラスターなどでリブートを経るとデバイス番号が固定ではない時有用．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>convert appledouble = <replaceable>BOOLEAN</replaceable>
          (デフォルト: <emphasis>yes</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>クライアントからのファイルシステムへのアクセス時， <option>appledouble = v2</option> から <option>appledouble = ea</option> への自動的な変換を行うかどうか．これは概して有用であるがいくらかパフォーマンスが犠牲となる．ボリューム上で <command>dbd</command> を実行しそれで変換をするのが推奨される．その後このオプションを no に設定することもできる．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>delete veto files = <replaceable>BOOLEAN</replaceable>
          (デフォルト: <emphasis>no</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>このオプションは Netatalk が一つあるいはそれ以上の veto されたファイルあるいはディレクトリ（veto files オプションを見よ）を削除しようとした時用いられる．もしこのオプションを no に設定し（デフォルト），そしてもしあるディレクトリが何か非 veto ファイルないしはディレクトリを含んでいたら，ディレクトリの削除は失敗するであろう．これは通常あなたの望むところの動作である．</para>
            <para>もしこのオプションが yes に設定されていたら，Netatalk は veto 化ディレクトリ・ディレクトリ内も含めあらゆるファイル，ディレクトリを再帰的に削除しようとするであろう．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>follow symlinks = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>デフォルトの設定では偽なのでサーバー上でシンボリックリンクは辿られない．これは OS X の AFP サーバーと同じ挙動である．オプションを真に設定すると afpd がサーバー上でシンボリックリンクを辿るようにさせる．今のところ afpd は "wide symlinks" を全く検査しないので，シンボリックリンクは AFP ボリューム以外を指しているかもしれない．</para>
            <note>
              <para>シンボリックリンクがファイルシステムの境界をまたいで張られている時，このオプションは巧妙に断ち切る．</para>
            </note>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>invisible dots = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>ドットファイルを不可視にする． 警告：このオプションを有効にすると，望まない副作用を OS X アプリケーションに引き起こす．つまり， 先頭がドットではじまる一時ファイルにファイルをセーブし，それから一時ファイルを最終的なファイル名にリネームした時， 結果としてセーブしたファイルが見えなくなる．唯一このオプションが有用なのは，Mac OS 9 でドットからはじまるファイルを見えなくさせるためである．Mac OS X では，Finder でもターミナルでもドットではじまるファイルはいずれにしても隠しファイルなので，完全に無駄である．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>network ids = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>yes</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>サーバーがネットワーク id をサポートするかどうか．これを <emphasis>no</emphasis> に設定すると結果としてクライアントは ACL AFP 機能を使わなくなる．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>preexec close = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>preexec からの 0 以外のリターンコードで，クライアントがボリュームをマウントする／見ることを防ぐために当該ボリュームを即座に閉じる．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>read only = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>その共有を全てのユーザーに対して読み込み専用と指定する．<option>ea = auto</option> は <option>ea = none</option> で上書きされる．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>root preexec close= <replaceable>BOOLEAN</replaceable>
          (デフォルト: <emphasis>no</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>root_preexec からの 0 以外のリターンコードで，クライアントがボリュームをマウントする／見ることを防ぐために当該ボリュームを即座に閉じる．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>search db = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>低速な再帰的ファイルシステム検索の代わりに高速な CNID データベースの名前検索を用いる．矛盾のない CNID データベースを信頼する，すなわち Samba やローカルのファイルシステムのアクセスが不正確さらには誤った結果を招く．"dbd" CNID db のボリュームのみで動作する．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>stat vol = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>yes</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>ボリュームリストを列挙するときにボリュームパスを stat するかどうか．オートマウントや preexec スクリプトで作成されたボリュームに有用である．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>time machine = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>no</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>このボリュームの Time Machine サポートを有効にするかどうか．</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>unix priv = <replaceable>BOOLEAN</replaceable> (デフォルト:
          <emphasis>yes</emphasis>) <type>(V)</type></term>

          <listitem>
            <para>AFP3 UNIX 権限を使うかどうか．これは OS X クライアントに対しては設定すべきである．<option>file perm</option>， <option>directory perm</option> 及び <option>umask</option> も参照．</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </refsect2>
  </refsect1>

  <refsect1>
    <title>CNID バックエンド</title>

    <para>AFP プロトコルはたいていはファイルとディレクトリを名前ではなく ID で参照する．Netatalk はこの ID を永続的な方法で保管する方法を必要とする．これを達成するためにいくつかの異なる CNID バックエンドが用意されている．CNID データベースはデフォルトで <filename>@localstatedir@/netatalk/CNID/(volumename)/.AppleDB/</filename> ディレクトリに置かれている．</para>

    <variablelist>
      <varlistentry>
        <term>cdb</term>

        <listitem>
          <para>"Concurrent database" バックエンドは Oracle Berkley DB を基礎としている．このバックエンドだと，いくつかの <command>afpd</command> デーモンが直接 CNID データベースにアクセスする．もし一つのボリュームあたり，一つ以上の <command>afpd</command> プロセスがアクティブならば，Berkeley DB ロッキングがアクセスを同期するために用いられる．欠点は単一の <command>afpd</command> プロセスのクラッシュがデータベースを壊すかもしれないということである．</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>dbd</term>

        <listitem>
          <para>CNID データベースへのアクセスは <command>cnid_metad</command> デーモンプロセスによって制限されている．<command>afpd</command> プロセスはこのデーモンとデータベースの読み込みと更新のために通信する．もし Berkeley DB トランザクションとでビルドすれば，データベースの壊れる可能性は経験的にはゼロである． しかし，パフォーマンスは <option>cdb</option> とによるものより遅いかもしれない．</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>last</term>

        <listitem>
          <para>このバックエンドは，ID の持続性の点では，例外である．ID はカレントセッションでしか有効ではない．これは基本的には <command>afpd</command> がバージョン 1.5（と1.6）で行ったことである．このバックエンドは，例えば共有 CD-ROM などで有用なので未だに有効である．Netatalk 3.0 からは，これは自動的に<emphasis>読み込み専用モード</emphasis>になる．</para>

          <para><emphasis role="bold">警告</emphasis>: 今や <command>afpd</command> が持続性のある ID データベースに重く依存しているので，このバックエンドをボリュームに使用するのはもはや推奨<emphasis>されていない</emphasis>．エイリアスはおそらく機能しないだろうし，ファイル名のマングリングもサポートされていない．</para>
        </listitem>
      </varlistentry>
    </variablelist>

    <para><command>./configure --help</command> で他の有効なバックエンドがあると表示するかもしれない．にも関わらずそれらは壊れていることもありえるし，あるいは主にテストのために使われていることを注意すべきである． あなたが何をしているのかわかっている場合以外はそれらを使用してはならない．それらは将来のバージョンでそれ以上の通告なく除去されるかもしれない．</para>
  </refsect1>

  <refsect1>
    <title>文字セットオプション</title>

    <para>OS XでAppleはAFP3プロトコルを導入した。最も重要な変更の一つは、AFP3は分解済UTF-8 としてエンコードされたUnicode名を用いることである。以前のAFP及びOSバージョンはMacRomanやMacCentralEuropeといったコードページを用いた。</para>

    <para><command>afpd</command>がunixファイルシステム上にファイルを保存するとき、拡張されたMacintosh文字やunixファイル名としては不正な文字を維持する方法が必要である。現在のバージョンは今、名前のためのデフォルトエンコーディングとしてUTF-8を用いる。「<keycode>/</keycode>」は「<keycode>:</keycode>」に変換される。</para>

    <para>初期のバージョンはいわゆるCAPエンコーディングを用いた。一つの拡張文字(&gt;0x7F)は一つの :xx シーケンスに変換された。例えば、Appleロゴ (MacRoman: 0xF0)は<literal>:f0</literal>として保存された。幾つかの特殊な文字も :xx表記として変換された。「<keycode>/</keycode>」は<literal>:2f</literal>にエンコードされ、先頭のドット「<keycode>.</keycode>」は<literal>:2e</literal>にエンコードされた。</para>

    <para><option>vol charset</option>オプションは他のボリュームエンコーディングを選べるようにする。<command>afpd</command>は
    <citerefentry>
        <refentrytitle><command>iconv</command></refentrytitle>

        <manvolnum>1</manvolnum>
      </citerefentry>
    が提供する如何なる文字セットも受け入れる。デフォルトのUTF-8を使うことをを強く推奨する。</para>
  </refsect1>

  <refsect1>
    <title>参照</title>

    <para><citerefentry>
        <refentrytitle>afpd</refentrytitle>

        <manvolnum>8</manvolnum>
      </citerefentry>, <citerefentry>
        <refentrytitle>afppasswd</refentrytitle>

        <manvolnum>5</manvolnum>
      </citerefentry>, <citerefentry>
        <refentrytitle>afp_signature.conf</refentrytitle>

        <manvolnum>5</manvolnum>
      </citerefentry>, <citerefentry>
        <refentrytitle>extmap.conf</refentrytitle>

        <manvolnum>5</manvolnum>
      </citerefentry>, <citerefentry>
        <refentrytitle>cnid_metad</refentrytitle>

        <manvolnum>8</manvolnum>
      </citerefentry></para>
  </refsect1>
</refentry>
